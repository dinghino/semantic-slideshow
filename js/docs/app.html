<!DOCTYPE html>

<html>
<head>
  <title>app.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>app.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-comment">/**
 * @file HTML Slideshow presenter.
 * This whole app is a style execrise to regain confidence with javascript ES5,
 * jQuery and semantic-ui framework. It's purpose is to have an instrument to
 * create an slideshow using simple &lt;tt&gt;HTML&lt;/tt&gt; pages and &lt;tt&gt;javascript&lt;/tt&gt;
 * configuration files and settings. This can allow a developer to quickly create
 * an insider slideshow to show progress on some code, live while presenting, to
 * have multiple team members create multiple slides that can work together with
 * no issues...
 * The App itself is a central state managed application, that uses
 * &lt;tt&gt;{@link App.setState}&lt;/tt&gt; to modify the current state and triggers, if
 * needed, behaviours into the initialized main components (&lt;tt&gt;namespaces&lt;/tt&gt;)
 * It dynamically loads slideshows and scripts from a specified folder.
 *
 * &lt;h3&gt;Primary hooks for the application&lt;/h3&gt;
 * Even though not needed for standard use, If you need to programmatically access
 * behaviours, moments and triggers of the application in a custom script you can
 * use these hooks to interface with the {@link App} and do stuff conditionally
 *
 * &lt;ul&gt;
 * &lt;li&gt;{@link App.setState} triggers a state update. should be the only interface
 *         								 with {@link App.state} but shouldn't be used anyway&lt;/li&gt;
 * &lt;li&gt;{@link App.didUpdate} called by {@link App.setState} after doing its stuff
 *         								 can be used to hook on state changes and trigger
 *         								 behaviours conditionally&lt;/li&gt;
 * &lt;li&gt;{@link Slides.go} triggers a slide change, both with a direciton or a slide number cx gvt
 */</span>


<span class="hljs-keyword">var</span> I = <span class="hljs-number">0</span>
<span class="hljs-keyword">var</span> INIT_TIME

<span class="hljs-comment">/**
 * Main application object. Handles events, initialization and general state of
 * the app.
 * This is the primary interface for the user to handle changes in the application
 * using App.setState() method.
 *
 * @version 0.9.4
 * @author Daniele Calcinai
 * @namespace
 */</span>
<span class="hljs-keyword">var</span> App = {</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>author info</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  info: {
    author: <span class="hljs-string">'Daniele Calcinai'</span>,
    email: <span class="hljs-string">'dinghino@gmail.com'</span>,
    gitHub: <span class="hljs-string">'https://github.com/dinghino'</span>,
    version: <span class="hljs-string">'0.9.4'</span>
  },
  <span class="hljs-comment">/**
   * Define the array length for App._prevStates
   * @type {Number}
   * @private
   */</span>
  _maxStateHistory: <span class="hljs-number">10</span>,
  <span class="hljs-comment">/**
   * stores App._maxStateHistory objects, being old App.state
   * @type {Array}
   * @private
   */</span>
  _prevStates: [{ ready: <span class="hljs-literal">true</span> }],
  <span class="hljs-comment">/**
   * Default global config for the app that can be overridden while calling
   * {@link App.init}
   * @type {Object}
   * @prop {Boolean} verbose - Log events from the app, including detailed state changes
   * @prop {Boolean} semanticLog - Turn on the semantic-ui default debugger. can't be set after
   *
   */</span>
  config: {
    verbose: <span class="hljs-literal">false</span>,
    semanticLog: <span class="hljs-literal">true</span>
  },
  <span class="hljs-comment">/**
   * Current state of the app. should be handled ONLY with .setState()
   */</span>
  state : {
    <span class="hljs-comment">/** @property {boolean} UI is toggled */</span>
    buttonShown: <span class="hljs-literal">false</span>,
    <span class="hljs-comment">/** @property {boolean} app initialization status */</span>
    initialized: <span class="hljs-literal">false</span>,
    <span class="hljs-comment">/** @property {boolean} true if custom events are present and ready */</span>
    events: <span class="hljs-literal">false</span>,
    <span class="hljs-comment">/** @property {bool} true if active, false if hidden */</span>
    dimmer: <span class="hljs-literal">false</span>,
    <span class="hljs-comment">/** {Number} total number of slides */</span>
    totalSlides: <span class="hljs-number">0</span>,
    <span class="hljs-comment">/** @property {number} currently shown slide */</span>
    currentSlide: <span class="hljs-number">1</span>,
    <span class="hljs-comment">/** {number} previously shown slide ~ used and set in transitions */</span>
    prevSlide: <span class="hljs-literal">undefined</span>,
    <span class="hljs-comment">/** {number} next slide to show ~ used and set in transitions */</span>
    nextSlide: <span class="hljs-literal">undefined</span>
  },

  <span class="hljs-comment">/**
   * Primary API for the application. changes the internal state object.
   * Has different callbacks for default and user definable actions based on
   * state changes
   * @param {object} nextState requested changes in the application
   */</span>
  setState: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">nextState</span>) </span>{
    <span class="hljs-keyword">var</span> verbose = App.config.verbose;
    <span class="hljs-keyword">if</span>(verbose) <span class="hljs-built_in">console</span>.time(<span class="hljs-string">'this set state took'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>validation for arguments</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> nextState !== <span class="hljs-string">'object'</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'new state should be an object!'</span>)
    };
    <span class="hljs-comment">/**
     * Assign oldState and newState objects properties
     */</span>
    <span class="hljs-keyword">var</span> prevState = $.extend(<span class="hljs-literal">true</span>, {}, App.state),
        <span class="hljs-comment">/** {object} merge the old state with the new props passed */</span>
        newState = <span class="hljs-built_in">Object</span>.assign(App.state, nextState);

    <span class="hljs-comment">/** add last state as first of _prevStates */</span>
    App._prevStates.unshift(prevState)

    <span class="hljs-comment">/** if length of array is &gt; 10, remove oldest one */</span>
    <span class="hljs-keyword">if</span>(App._prevStates.length &gt; App._maxStateHistory) { App._prevStates.pop() }

    <span class="hljs-comment">/**
     * check the changes in the state and return a diff object
     * {objects} differences between old state and new state
     *                 diff is structured as diff[propName]: {prev, next}
     */</span>
    <span class="hljs-keyword">var</span> diff = App.checkStateDiffs(prevState, newState)
    <span class="hljs-comment">/** if requested log the state update informations */</span>
    <span class="hljs-keyword">if</span> (verbose) App.__setStateLog(prevState, nextState, diff, newState)

    <span class="hljs-comment">/**
     * update current state with the new object
     * @private
     */</span>
    App.state = newState


    <span class="hljs-comment">/** if &lt;diff&gt; is popuplated handle the change */</span>
    <span class="hljs-keyword">if</span> (diff) App.onStateChange(prevState, newState, diff);

    <span class="hljs-comment">/** call the user defined method */</span>
    App.didUpdate(prevState);
  },

  <span class="hljs-comment">/**
   * retrieve a state object from the history (_prevStates) or the whole array
   * if no argument is specified
   * @param  {number} idx optional. range from 0 to App._maxStateHistory
   */</span>
  getOldState: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">idx</span>) </span>{
    <span class="hljs-comment">/** if no idx is passed return the whole array */</span>
    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> idx !== <span class="hljs-string">'number'</span>) <span class="hljs-keyword">return</span> App._prevStates;

    <span class="hljs-comment">/** {Boolean} wether the passed index is a valid OLD App.state  */</span>
    isOldState = <span class="hljs-keyword">typeof</span> idx === <span class="hljs-string">'number'</span> &amp;&amp; <span class="hljs-number">0</span> &gt;= idx &lt;= App._maxStateHistory;

    <span class="hljs-keyword">if</span> (!isOldState) {
      <span class="hljs-keyword">var</span> err = <span class="hljs-string">'passed index is not valid. values from 0 to '</span>
                + App._maxStateHistory + <span class="hljs-string">' are valid'</span>;

      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(err)
    };

    <span class="hljs-comment">/** find the requested old state */</span>
    <span class="hljs-keyword">var</span> oldState = App._prevStates[idx]

    <span class="hljs-comment">/** check if it's an object. if not (undefined) return it */</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> oldState === <span class="hljs-string">'object'</span>) <span class="hljs-keyword">return</span> oldState;

    <span class="hljs-comment">/** if oldState is not an {object} throw an error just in case */</span>
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'requested old state index do not exists yet.'</span>)
  },

  <span class="hljs-comment">/**
   * evaluate the differences between two state objects
   * @private
   * @param  {object} prevState - a previous state of the app
   * @param  {object} nextState - a next state of the app
   * @return {object|Boolean}     if diffs exists return an object containing
   *                                the differences from prevState to nextState
   *                                otherwhise return false
   */</span>
  checkStateDiffs: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">prevState, nextState</span>) </span>{
    <span class="hljs-keyword">var</span> keys    = <span class="hljs-built_in">Object</span>.keys(nextState),
        getDiff = <span class="hljs-literal">false</span>
        <span class="hljs-comment">/** log strings */</span>
        changes  = {};

    keys.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">k, i</span>) </span>{
      <span class="hljs-comment">/** check for changes in present properties */</span>
      <span class="hljs-keyword">var</span> changed = prevState[k] !== nextState[k];

      <span class="hljs-keyword">if</span> (changed) {
      getDiff = <span class="hljs-literal">true</span>;
      <span class="hljs-comment">/** {Object} store changes informations */</span>
      <span class="hljs-keyword">var</span> change  = { previous: prevState[k], next: nextState[k] };

      <span class="hljs-comment">/** assign newly created object to changes[k] */</span>
      changes[k] = change;
      }
    })
    <span class="hljs-comment">/** return the objects containing the changes */</span>
    <span class="hljs-keyword">if</span>(getDiff) <span class="hljs-keyword">return</span> changes
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
  },

  <span class="hljs-comment">/**
   * Default behaviour on state changes. triggers app events.
   * should only be used internally and not accessed from the user
   * @param  {object} prevState previous state of the app
   * @param  {object} nextState next state of the app
   * @param  {object} diff      must contains the diffs within the
   *                            &lt;strong&gt;passed&lt;/strong&gt; states
   */</span>
  onStateChange: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">prevState, nextState, diff</span>) </span>{
    <span class="hljs-comment">/** {array} property changed */</span>
    <span class="hljs-keyword">var</span> changed = <span class="hljs-built_in">Object</span>.keys(diff),
        pS      = prevState,
        nS      = nextState,
        d       = diff;

    <span class="hljs-comment">/** activate the dimmer if state changed */</span>
    <span class="hljs-keyword">if</span> (d.dimmer) Dimmer.set(nS.dimmer)

    <span class="hljs-comment">/**
     * if nextSlide changed and is present in nextSlide, render the slides.
     * evaluation of the next slide number is already done. after animating state
     * will get the new current (should be old next), new prev and undefined next
     */</span>
    <span class="hljs-keyword">if</span> (d.nextSlide &amp;&amp; nS.nextSlide) Slides.render()

    <span class="hljs-keyword">if</span> (d.buttonShown) Interface.toggleUI() <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> give it a proper method in Interface</span>
  },

  <span class="hljs-comment">/**
   * similar to react's componentDidUpdate, is called after the app updated
   * its state and the old state is set to into the history
   * @param  {object} prevState App.state before the update
   */</span>
  didUpdate: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">prevState</span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>user definable function, can be used to trigger stuff
if App.state[prop] !== prevState[prop]</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  },

  <span class="hljs-comment">/**
   * be verbose about changes in App.state and go full console!
   * Must be called after the {@link App.setState} completed the update
   * @private
   * @param  {object} oldState  - the immediately previous state of the app
   * @param  {object} nextState - the changes that triggered the state change
   * @param  {object} changes   - a diff object created with {@link App.checkStateDiffs}
   * @param  {object} newState  - the newly created state
   */</span>
  __setStateLog: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">oldState, nextState, changes, newState</span>) </span>{
    <span class="hljs-keyword">var</span> propsChanged = changes ? <span class="hljs-built_in">Object</span>.keys(changes).length : <span class="hljs-number">0</span>,
        now          = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().getTime(),
        timestamp    = ((now - INIT_TIME) / <span class="hljs-number">1000</span>).toFixed(<span class="hljs-number">3</span>) + <span class="hljs-string">'s'</span>

    <span class="hljs-built_in">console</span>.groupCollapsed(
      <span class="hljs-string">'[%s][%d] updating state with %d changes:'</span>,
      timestamp, I++, propsChanged, nextState)
      <span class="hljs-built_in">console</span>.trace(<span class="hljs-string">'update callers chain'</span>)
      <span class="hljs-built_in">console</span>.groupCollapsed(<span class="hljs-string">'changes table'</span>)
        <span class="hljs-built_in">console</span>.table(changes)
      <span class="hljs-built_in">console</span>.groupEnd()
      <span class="hljs-built_in">console</span>.groupCollapsed(<span class="hljs-string">'state objects'</span>)
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'prev:'</span>, oldState)
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'next:'</span>, newState)
      <span class="hljs-built_in">console</span>.groupEnd()
    <span class="hljs-built_in">console</span>.timeEnd(<span class="hljs-string">'this set state took'</span>)
    <span class="hljs-built_in">console</span>.groupEnd()

  },

  <span class="hljs-comment">/**
   * Initialize the whole app, starting sub .init() method, activating event
   * listeners and setting default parameters here and there
   * @param  {object} config configuration object for the app. will merge with {@link App.config}
   */</span>
  init: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">config</span>) </span>{
    <span class="hljs-comment">/** save the time of the App.init to be used in logs and stuff */</span>
    INIT_TIME = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().getTime()
    <span class="hljs-comment">/** merge custom config for the app. used primarly to toggle debugging */</span>
    <span class="hljs-keyword">if</span> (config) {
      <span class="hljs-built_in">console</span>.info(<span class="hljs-string">'custom global config detected! merging'</span>, config)
      App.config = <span class="hljs-built_in">Object</span>.assign(App.config, config)
    };

    <span class="hljs-comment">/** enable semantic-ui debugger if verbose is true */</span>
    <span class="hljs-keyword">if</span> (App.config.semanticLog) $.site(<span class="hljs-string">'enable debug'</span>);

    <span class="hljs-comment">/** add custom app event listeners to objects and DOM */</span>
    App._events()
    <span class="hljs-comment">/** set the about section content */</span>
    App.setAboutInfo()
    <span class="hljs-comment">/** initialize the buttons and their events */</span>
    Interface.init()
  },

  <span class="hljs-comment">/**
   * validate the selected folder before calling App.loadSlideshow()
   * avoiding unwanted initialization
   * @param  {string} folderName folder to validate
   * @param  {func}   success    called if folderName is found
   * @param  {func}   failure    called if foldername is NOT found
   */</span>
  validateSlideshowFolder: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">folderName, onSuccess, onFail</span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>define the path to the test file</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> test    = folderName + <span class="hljs-string">'/1.html'</span>,
        verbose = App.config.verbose;

    $.get(test)
    .success(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span> (verbose) <span class="hljs-built_in">console</span>.info(folderName + <span class="hljs-string">'/ found! proceeding'</span>)
        <span class="hljs-keyword">if</span> (onSuccess) onSuccess();
      })
    .fail(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span> (verbose) <span class="hljs-built_in">console</span>.warn(folderName + <span class="hljs-string">'/ NOT found! Check it'</span>);
        <span class="hljs-keyword">if</span> (onFail) onFail();
      }
    )
  },

  <span class="hljs-comment">/**
   * event triggers
   */</span>

  <span class="hljs-comment">/** load a slideshow with the given total slides and configuration */</span>
  loadSlideshow: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">config</span>) </span>{
    $(App).trigger(<span class="hljs-string">'app:loadSlides'</span>, [config])
  },
  <span class="hljs-comment">/** update Slides.config object with custom config */</span>
  updateConfig: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">config</span>) </span>{
    $(App).trigger(<span class="hljs-string">'app:set-slide-config'</span>, [config])
  },
  <span class="hljs-comment">/** get the custom script file from the slideshow folder
   * @param  {string} fileName will be used in a later release,
   *                           allowing custom names for script.js
   */</span>
  fetchEvents: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">fileName</span>) </span>{
    <span class="hljs-keyword">var</span> verbose = App.config.verbose;

    <span class="hljs-keyword">if</span> (!fileName) fileName = <span class="hljs-string">'script'</span>

    <span class="hljs-keyword">if</span> (!Slides.config.getEvents) {
      <span class="hljs-keyword">return</span> App.slidesReady()
    }
    <span class="hljs-keyword">var</span> path = Slides.config.folder + <span class="hljs-string">'/'</span> + fileName + <span class="hljs-string">'.js'</span>

    $.getScript(path)
    .done(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">script, status</span>) </span>{
      <span class="hljs-keyword">if</span> (verbose) <span class="hljs-built_in">console</span>.info(<span class="hljs-string">'script found!'</span>, status, <span class="hljs-string">'activating.'</span>)
      App.enableEvents()
    })
    .fail(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">jqxhr, settings, exception</span>) </span>{
      <span class="hljs-keyword">if</span> (verbose) <span class="hljs-built_in">console</span>.warn(
        <span class="hljs-string">'no extra script found in "'</span> + Slides.config.folder + <span class="hljs-string">'/"'</span>, jqxhr.status
      )
      App.slidesReady()
    });
  },
  <span class="hljs-comment">/** enable custom events */</span>
  enableEvents: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{ $(App).trigger(<span class="hljs-string">'app:enable-custom-events'</span>) },
  <span class="hljs-comment">/** finalize the initialization of the slides */</span>
  slidesReady: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{ $(App).trigger(<span class="hljs-string">'app:slides-ready'</span>) },
  <span class="hljs-comment">/** finalize initialization of the whole app */</span>
  finalizeApp: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{ $(App).trigger(<span class="hljs-string">'app:finalize-init'</span>) },

  <span class="hljs-comment">/**
   * Adds custom event listeners to {@link App}, created with jQuery.
   * @private
   */</span>
  _events: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    $(App)
    .on(<span class="hljs-string">'app:set-slide-config'</span>, App._onSetConfig)
    .on(<span class="hljs-string">'app:loadSlides'</span>, App._onLoadSlides)
    .on(<span class="hljs-string">'app:slides-ready'</span>, App._onSlideShowReady)
    .on(<span class="hljs-string">'app:finalize-init'</span>, App._onFinalizeInit)
    .on(<span class="hljs-string">'app:enable-custom-events'</span>, App._onEnableEvents)
  },

  <span class="hljs-comment">/**
   * Internal event handlers that are used to perfom some basic actions like
   * updating the {@link App} config and/or trigger other events to chain them
   * in a proper workflow
   * <span class="hljs-doctag">TODO:</span> create comments for each one of these so it's easier to know what they
   * do. make them if seems the right thing to do.
   * @private
   */</span>
  _onLoadSlides: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e, config</span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>initia lizing slideshow</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    App.updateConfig(config)
    Slides.init()
  },
  _onSetConfig: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e, config</span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>assigning configuration to app</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    Slides.config = <span class="hljs-built_in">Object</span>.assign(Slides.config, config)
  },
  _onSlideShowReady: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
    Interface.updateButtons()</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>if custom events are present in config and not yet executed run that
first before finalizing initialization</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span>(Slides.config.events &amp;&amp; !App.state.events) {
      App.enableEvents()
      <span class="hljs-keyword">return</span></pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>if no extra events are presents or are already set, finalize init</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    } <span class="hljs-keyword">else</span> { App.finalizeApp() };
  },
  _onFinalizeInit: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>if app is already initialized warn the user</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span> (App.state.initialized === <span class="hljs-literal">true</span>) {
      <span class="hljs-built_in">console</span>.warn(<span class="hljs-string">'initialization called more than once. check it!'</span>)
      <span class="hljs-keyword">return</span>
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>set initial state for the buttons.
if necessary do stuff to the UI</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    Counter.init();
    <span class="hljs-keyword">if</span> (Slides.config.showButtons &amp;&amp; !App.state.initialized) {
      setTimeout(Interface.toggle, <span class="hljs-number">150</span>);
    };</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>remove the dimmer</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
      App.setState({
        dimmer: <span class="hljs-literal">false</span>,
        initialized: <span class="hljs-literal">true</span>
      })
    }, <span class="hljs-number">750</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>call the onEnter event for the first slide after loading</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    Slides.onEnter(App.state.currentSlide)
  },
  _onEnableEvents: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'activating events'</span>)
    Slides.config.events = <span class="hljs-built_in">window</span>._slidesEvents
    <span class="hljs-keyword">var</span> events = Slides.config.events</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>if events exists and is  function execute.
timeout is needed for the DOM creation</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    events &amp;&amp; <span class="hljs-keyword">typeof</span> events === <span class="hljs-string">'function'</span> ? setTimeout(events, <span class="hljs-number">50</span>) : <span class="hljs-literal">null</span></pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>set events as executed</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    App.setState({ events: <span class="hljs-literal">true</span> })</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>run init validation again</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    App.slidesReady()
  },

  /**
   * utility methods
   */

  /** get the about info and set them into the page */
  setAboutInfo: function () {
    var info = App.info
    if(!info.email) about.authorEmail.hide()
    if(!info.gitHub) about.authorGitHub.hide()

    about.appVersion.text(info.version)
    about.authorEmail.attr('href', ('mailto:'+ info.email))
    about.authorGitHub.attr('href', info.gitHub)
  },
};

/**
 * Controller for the slideshow. contains Slides.config, passed down on
 * initialization of the slideshow by Slides.init()
 * Secondary API. exposes controls to manage state changes for the slideshow
 * such as Slides.go() to request a change to a slide.
 *
 * @namespace
 */
var Slides = {
  /** {element} DOM Element that will contain our slides */
  container: $slideContainer,

  /** {object} configuration for the application. contains default properties */
  config: {
    /** folder that contains the slides */
    folder: 'slides',

    /** hash string for the browser address. will get the current slide # after */
    hash: 'slide',

    /** default animations for slide transition */
    transition: {
      left: 'fade left',
      right: 'fade right',
    },

    /** {String} used when creating the slides to override semantic-ui */
    defaultSlideStyle: 'display: -webkit-flex!important; display: flex!important',

    /** {bool} if true try to get the custom .js file for the slideshow */
    getEvents: false,

    /** start with button toggled on or off */
    showButtons: true
  },

  /**
   * initialize the slideshow
   */
  init: function () {
    /** INITIALIZATION */

    /** toggle the dimmer to 'show', hiding content loading */
    App.setState({ dimmer: true })
    Slides.addEventListeners()

    /** reset app initialization to false if needed */
    App.state.initialized === true ? App.setState({ initialized: false }) : null;

    /** empty the slide container */
    Slides.container.empty();

    /** START LOADING */
    Slides.getContent()

    /** INITIAL EVENTS */

    /**  listen to key press events */
    Interface.addKeyPressEvents();

    Slides.updateHash();
  },

  addEventListeners: function () {
    $(Slides).on('slides:request-transition', Slides.evaluateTransition)
  },

  _createSlide: function (idx)  {
    var hash = Slides.config.hash;

    return $('&lt;div&gt;', {
      id: hash + idx,
      class: idx &gt; 1 ? 'transition hidden' : 'transition visible',
      style: idx === 1
                ? 'display: -webkit-flex!important; display: flex!important'
                : ''
    })[0]
  },

  getContent: function () {
    if (App.config.verbose) console.log('fetching slides')</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>local config</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> frag        = <span class="hljs-built_in">document</span>.createDocumentFragment(),
        hash        = Slides.config.hash,
        slidesQty   = <span class="hljs-number">1</span>,
        folder      = Slides.config.folder,
        loadStatus  = <span class="hljs-string">'OK'</span>,
        i = <span class="hljs-number">0</span>,
        bit;


    <span class="hljs-comment">/** handle the error from the ajax call in case it fails */</span>
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleError</span> (<span class="hljs-params">e</span>) </span>{
      <span class="hljs-keyword">if</span> (e.status == <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-string">' Check Your Network.'</span>;
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (e.status == <span class="hljs-number">404</span>) {
        <span class="hljs-built_in">console</span>.warn(<span class="hljs-string">'Seems we loaded the last slide. You have '</span>, slidesQty, <span class="hljs-string">'slides'</span>);
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (e.status == <span class="hljs-number">500</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-string">'Internel Server Error.'</span>;
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-string">'Unknow Error.\n'</span> + e.responseText;
      }
    };</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>fetch function for ajax request with $.get()</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ajaxCall</span> (<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">if</span> (loadStatus !== <span class="hljs-string">'OK'</span>) <span class="hljs-keyword">return</span>;

      <span class="hljs-keyword">var</span> nextSlide = folder + <span class="hljs-string">'/'</span> + slidesQty + <span class="hljs-string">'.html'</span>;
      bit = Slides._createSlide(slidesQty)

      $.get(nextSlide)
      .fail(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
        --slidesQty
        <span class="hljs-comment">/** error handling */</span>
        <span class="hljs-keyword">var</span> error = handleError(e)
        <span class="hljs-keyword">if</span> (error) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(error);

        <span class="hljs-comment">/**
         * Since fail means that there are no more slides to load,
         * append everything into the dom and continue configuring the slideshow
         */</span>

        <span class="hljs-comment">/** save slide quantity in App.state */</span>
        App.setState({ totalSlides: slidesQty })

        <span class="hljs-comment">/** append the fragments to the DOM into this.config.container */</span>
        Slides.container.append(frag)

        <span class="hljs-comment">/** execute callback function */</span>
        setTimeout(App.fetchEvents, <span class="hljs-number">0</span>);
      })
      .success(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">data, status, xhr</span>) </span>{
        <span class="hljs-comment">/** create and append the slide to the fragments */</span>
        $(bit).append($(data)[<span class="hljs-number">0</span>]);
        frag.appendChild(bit);

        <span class="hljs-keyword">if</span> (status === <span class="hljs-string">'error'</span>) loadStatus = status
        ++slidesQty
        ajaxCall()
      })
    };

    <span class="hljs-comment">/** execute the slides fetching */</span>
    ajaxCall()
  },

  <span class="hljs-comment">/** render and animate the slides, updating values if necessary */</span>
  render: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-comment">/** execute the animation for the slides */</span>
    setTimeout(Slides.animate, <span class="hljs-number">10</span>)
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>///////////////////
EVENT HANDLERS ///
///////////////////</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
  <span class="hljs-comment">/**
   * evaluate transition if moving to {direction} and store into App.state
   * @param {string} direction the direction to move.
   *                 one of 'next', 'prev', 'first', 'last'
   */</span>
  evaluateTransition: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e, data</span>) </span>{
    <span class="hljs-comment">/** local variables */</span>
    <span class="hljs-keyword">var</span> currentSlide = App.state.currentSlide,
        lastSlide    = App.state.totalSlides,
        request      = data;

    <span class="hljs-comment">/** validate and request transition if typeof data === number */</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> request === <span class="hljs-string">'number'</span>) {
      <span class="hljs-keyword">if</span> (request &gt; <span class="hljs-number">0</span> &amp;&amp; request &lt;= lastSlide) {
       App.setState({ nextSlide: request })
       <span class="hljs-keyword">return</span>
      }

      <span class="hljs-keyword">if</span> (request &lt; <span class="hljs-number">1</span>) {
        <span class="hljs-built_in">console</span>.warn(<span class="hljs-string">'requested an invalid slide: #%d. going to first'</span>, request)
        App.setState({ nextSlide: <span class="hljs-number">1</span> })
        <span class="hljs-keyword">return</span>
      }

      <span class="hljs-keyword">if</span> (request &gt; lastSlide) {
        <span class="hljs-built_in">console</span>.warn(<span class="hljs-string">'requested slide [%d] do not exists. going to last'</span>, request)
        App.setState({ nextSlide: lastSlide})
        <span class="hljs-keyword">return</span>
      }
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'was trying to go slide %s, but it seems you crashed me.'</span>)
    }

    <span class="hljs-comment">/**
     * update object properties depending on where we are going.
     * if case is no match throw an error | shouldn't happen from UI
     */</span>
    <span class="hljs-keyword">switch</span> (request) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">'next'</span>:
        App.setState({ nextSlide: currentSlide + <span class="hljs-number">1</span> })
        <span class="hljs-keyword">break</span>

      <span class="hljs-keyword">case</span> <span class="hljs-string">'prev'</span>:
        App.setState({ nextSlide: currentSlide - <span class="hljs-number">1</span> })
        <span class="hljs-keyword">break</span>

      <span class="hljs-keyword">case</span> <span class="hljs-string">'first'</span>:
        App.setState({ nextSlide: <span class="hljs-number">1</span> })
        <span class="hljs-keyword">break</span>

      <span class="hljs-keyword">case</span> <span class="hljs-string">'last'</span>:
        App.setState({ nextSlide: lastSlide })
        <span class="hljs-keyword">break</span>

      <span class="hljs-keyword">default</span>:
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'Error while moving... what did you do? You nasty...'</span>)
    }
  },

  <span class="hljs-comment">/**
   * high level API. tries to move the slides in a direction
   * @param  {string|number} nextSlide one of 'next', 'prev', 'first', 'last'
   *                                   can also be a number to JUMP directly
   *                                   to a slide passing a number.
   */</span>
  go: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">nextSlide</span>) </span>{
    $(Slides).trigger(<span class="hljs-string">'slides:request-transition'</span>, [nextSlide])
  },

  onEnter: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">slide</span>) </span>{
    <span class="hljs-keyword">var</span> events        = Slides.config.events,
        slidesEvents  = {};

    <span class="hljs-keyword">if</span> (events) { slidesEvents = Slides.config.events[slide] };

    <span class="hljs-keyword">if</span> (!slidesEvents) <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">var</span> fn = slidesEvents.onEnter</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>end the function if event is not present</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span> (!fn || <span class="hljs-keyword">typeof</span> fn !== <span class="hljs-string">'function'</span>) <span class="hljs-keyword">return</span>

    fn()
  },

  onLeave: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">slide</span>) </span>{
    <span class="hljs-keyword">var</span> events        = Slides.config.events,
        slidesEvents  = {};

    <span class="hljs-keyword">if</span> (events) { slidesEvents = Slides.config.events[slide] };

    <span class="hljs-keyword">if</span> (!slidesEvents) <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">var</span> fn = slidesEvents.onLeave</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>end the function if event is not present</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span> (!fn || <span class="hljs-keyword">typeof</span> fn !== <span class="hljs-string">'function'</span>) <span class="hljs-keyword">return</span>

    fn()
  },

  <span class="hljs-comment">/**
   *  handler for the animation to move the slides
   */</span>
  animate: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"><span class="hljs-comment">/*nextSlide*/</span></span>) </span>{
    <span class="hljs-keyword">var</span> prevSlide   = App.state.currentSlide,
        nextSlide   = App.state.nextSlide,
        slides      = Slides.container.children(),
        value       = Slides.translateAmount,
        hash        = Slides.config.hash;
        prev        = <span class="hljs-string">''</span>,
        next        = <span class="hljs-string">''</span>,
        transition = {
          enter: <span class="hljs-string">''</span>,
          leave: <span class="hljs-string">''</span>
        };

    <span class="hljs-comment">/**
     * Get the dom elements corresponding the slides to animate. also works as
     * validator for the passed values
     */</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> prevSlide === <span class="hljs-string">'number'</span>) prev = $(<span class="hljs-string">'#'</span>+ hash + prevSlide);
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> nextSlide === <span class="hljs-string">'number'</span>) next = $(<span class="hljs-string">'#'</span>+ hash + nextSlide);

    <span class="hljs-keyword">if</span> (next.length === <span class="hljs-number">0</span> || prev.length === <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(
        <span class="hljs-string">'Error while trying to animate the slideshow'</span>,
        <span class="hljs-string">'\nSeems we couldn\'t find the slides to animate'</span>)
    }

    <span class="hljs-comment">/** set the animations to use for the transition */</span>
    <span class="hljs-keyword">if</span> (prevSlide &gt; nextSlide) {
      transition.leave = Slides.config.transition.left
      transition.enter = Slides.config.transition.right
    } <span class="hljs-keyword">else</span> {
      transition.leave = Slides.config.transition.right
      transition.enter = Slides.config.transition.left
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>update DOM</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    prev.transition({
      animation: transition.leave,</pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <p>handle the event listeners</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      onStart: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        <span class="hljs-comment">/** disable transition controls to avoid mess */</span>
        Interface.disableTransitions()
        <span class="hljs-comment">/** call the onLeave method for current slide */</span>
        Slides.onLeave(prevSlide)
      }
    })
    next.transition({
      animation: transition.enter,
      onStart: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        <span class="hljs-comment">/** activate onEnter for nextSlide slide */</span>
        Slides.onEnter(nextSlide)
      },</pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p>handle the event listeners</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      onComplete: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        Interface.restoreTransitions()
      }
    })

    <span class="hljs-comment">/** update the state object with the new slides status */</span>
    App.setState({
      currentSlide: nextSlide,
      prevSlide: prevSlide,
      nextSlide: <span class="hljs-literal">undefined</span>
    })


    <span class="hljs-comment">/** call update UI with the new state */</span>
    Counter.set()
    Interface.updateButtons()
    Slides.updateHash()
  },

  <span class="hljs-comment">/**
   *  update the address on the browser
   */</span>
  updateHash: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> hash  = Slides.config.hash,
        slide = App.state.currentSlide;</pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <p>update the address hash</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    location.hash = hash + slide
  }
};

<span class="hljs-comment">/**
 * Handles the counter for the slide and the slide jumper behaviour
 * @namespace
 */</span>
<span class="hljs-keyword">var</span> Counter = {
  init: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-comment">/** set counter initial state */</span>
    Counter.set()
  },

  <span class="hljs-comment">/** set the value of the label if present */</span>
  set: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> current = App.state.currentSlide,
        total   = App.state.totalSlides,
        <span class="hljs-comment">/** {string}  label text */</span>
        text    = current + <span class="hljs-string">' of '</span> + total,
        <span class="hljs-comment">/** {node} DOM element for the label text */</span>
        $label  = $counter.find(<span class="hljs-string">'.labelText'</span>);

    <span class="hljs-comment">/** update the label value */</span>
    $($label[<span class="hljs-number">0</span>]).text(text)
    $jumperInput.val(current)
  },
  toggle: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{ $counter.transition(<span class="hljs-string">'fly up'</span>) }
}

<span class="hljs-comment">/**
 * handles the page dimmer created in index.html.
 * @namespace
 */</span>
<span class="hljs-keyword">var</span> Dimmer = {
  states: [<span class="hljs-string">'show'</span>, <span class="hljs-string">'hide'</span>],

  <span class="hljs-comment">/** triggers */</span>
  set: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">status</span>) </span>{ $(Dimmer).trigger(<span class="hljs-string">'dimmer:set'</span>, [status]) },
  toggle: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{ App.setState({ dimmer: !App.state.dimmer }) },
  <span class="hljs-comment">/** add event listeners */</span>
  init: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    $(Dimmer).on(<span class="hljs-string">'dimmer:set'</span>, { status: status }, Dimmer._changeState)
  },

  <span class="hljs-comment">/**
   * change the state of the dimmer, showing or hiding it
   * @param  {object} e       event from $.trigger()
   * @param  {bool}   request true show, false hide
   */</span>
  _changeState: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e, request</span>) </span>{
    <span class="hljs-comment">/** {string} 'show' or 'hide' depending on true|false */</span>
    <span class="hljs-keyword">var</span> state = request === <span class="hljs-literal">true</span> ? Dimmer.states[<span class="hljs-number">0</span>] : Dimmer.states[<span class="hljs-number">1</span>]

    $dimmer.dimmer(state)
  },

};

<span class="hljs-comment">/**
 * Handles the events for the control buttons rendered on screen
 * @namespace
 */</span>
<span class="hljs-keyword">var</span> Interface = {
  <span class="hljs-comment">/**
   * initialize the buttons with their events called from Slides.
   */</span>
  init: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (App.config.verbose) <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'initializing interface'</span>)

    <span class="hljs-comment">/** initialize interface with semantic-ui modules */</span>
    Interface.enableSemanticModules()

    <span class="hljs-comment">/** initialize the dimmer */</span>
    Dimmer.init()

    <span class="hljs-comment">/** add basic event listeners */</span>
    Interface.addEventListeners()
  },

  <span class="hljs-comment">/** Activate slideshow UI semantic-ui modules */</span>
  enableSemanticModules: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-comment">/** help popup from [?] button */</span>
    $helpIcon.popup({
      inline: <span class="hljs-literal">true</span>,
      position: <span class="hljs-string">'top left'</span>,
      on: <span class="hljs-string">'click'</span>,
      transition: <span class="hljs-string">'vertical flip'</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <p>close the about section when popup closes</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      onHide: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{ $authorAccordion.accordion(<span class="hljs-string">'close'</span>, <span class="hljs-number">0</span>) }
    });

    $($counterLabel).popup({
      on: <span class="hljs-string">'click'</span>,
      inline: <span class="hljs-literal">true</span>
    })

    <span class="hljs-comment">/** about &amp; contacts accordion */</span>
    $authorAccordion.accordion()
    <span class="hljs-comment">/** dimmer settings */</span>
    $dimmer.dimmer({
      duration: {
        show: <span class="hljs-number">500</span>,
        hide: <span class="hljs-number">500</span>
      }
    })
  },

  <span class="hljs-comment">/** basic event listeners for the UI */</span>
  addEventListeners: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

    <span class="hljs-comment">/** call is done in more than one event. shortening */</span>
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toggleDimmer</span> (<span class="hljs-params"></span>) </span>{
      App.setState({ dimmer: !App.state.dimmer })
    };

    <span class="hljs-comment">/** custom events */</span>
    $(Interface).on(<span class="hljs-string">'interface:toggle'</span>, Interface.onToggleUI);
    $(Interface).on(<span class="hljs-string">'interface:update-btns'</span>, Interface.onToggleButtons);

    <span class="hljs-comment">/** click events for slides buttons */</span>
    Interface.addNavigationListeners();

    <span class="hljs-comment">/** event for the toggler button */</span>
    $button.toggle.on(<span class="hljs-string">'click'</span>, Interface.toggle);
    <span class="hljs-comment">/** event for the black screen button */</span>
    $button.black.on(<span class="hljs-string">'click'</span>, Dimmer.toggle);
    <span class="hljs-comment">/** event handler for the dimmer click */</span>
    $dimmer.on(<span class="hljs-string">'click'</span>, Dimmer.toggle)

    $button.jump.on(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> nextSlide = $jumperInput.val();
      isInvalid = !nextSlide || <span class="hljs-built_in">isNaN</span>(<span class="hljs-built_in">parseInt</span>(nextSlide))
      <span class="hljs-keyword">if</span> (isInvalid) <span class="hljs-keyword">return</span>
      <span class="hljs-built_in">console</span>.log(nextSlide)
      Slides.go(<span class="hljs-built_in">parseInt</span>(nextSlide))
    })

  },

  <span class="hljs-comment">/** add functionality to the navigational buttons */</span>
  addNavigationListeners: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    $button.first.on(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
      Slides.go(<span class="hljs-string">'first'</span>)
    });
    $button.prev.on(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
      Slides.go(<span class="hljs-string">'prev'</span>)
    });
    $button.next.on(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
      Slides.go(<span class="hljs-string">'next'</span>)
    });
    $button.last.on(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
      Slides.go(<span class="hljs-string">'last'</span>)
    });
  },

  <span class="hljs-comment">/** validate a keyCode from a keypress to handle navigation */</span>
  validateKeyPress: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">key</span>) </span>{
    <span class="hljs-comment">/**
     * keycode shortcuts * legend
     *
     * right:     -&gt; key, presenter right, SPACE
     * left:      &lt;- key, presenter left
     * home:      HOME key
     * end:       END key
     * toggle:    T key
     * blackout:  "." (mark) key, presenter black screen
     */</span>
    <span class="hljs-keyword">if</span> (key === <span class="hljs-number">39</span> || key === <span class="hljs-number">34</span> || key === <span class="hljs-number">32</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">'right'</span>;
    <span class="hljs-keyword">if</span> (key === <span class="hljs-number">37</span> || key === <span class="hljs-number">33</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">'left'</span>;
    <span class="hljs-keyword">if</span> (key === <span class="hljs-number">36</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">'home'</span>;
    <span class="hljs-keyword">if</span> (key === <span class="hljs-number">35</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">'end'</span>;
    <span class="hljs-keyword">if</span> (key === <span class="hljs-number">84</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">'toggle'</span>;
    <span class="hljs-keyword">if</span> (key === <span class="hljs-number">190</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">'dim'</span>;

    <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>
  },

  <span class="hljs-comment">/** handle a keypress in the page, when listeners are active */</span>
  handleKeyPress: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
    <span class="hljs-keyword">var</span> key     = Interface.validateKeyPress(e.keyCode),
        onFirst = App.state.currentSlide === <span class="hljs-number">1</span>,
        onLast  = App.state.currentSlide === App.state.totalSlides;

    <span class="hljs-comment">/** if one of those is true decide what to do */</span>
    <span class="hljs-keyword">switch</span> (key) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">'left'</span>:
        e.preventDefault();
        <span class="hljs-keyword">if</span> (onFirst) <span class="hljs-keyword">break</span>;
        Slides.go(<span class="hljs-string">'prev'</span>)
        <span class="hljs-keyword">break</span>

      <span class="hljs-keyword">case</span> <span class="hljs-string">'right'</span>:
        e.preventDefault();
        <span class="hljs-keyword">if</span> (onLast) <span class="hljs-keyword">break</span>;
        Slides.go(<span class="hljs-string">'next'</span>)
        <span class="hljs-keyword">break</span>

      <span class="hljs-keyword">case</span> <span class="hljs-string">'home'</span>:
        e.preventDefault();
        <span class="hljs-keyword">if</span>(onFirst) <span class="hljs-keyword">break</span>
        Slides.go(<span class="hljs-string">'first'</span>)
        <span class="hljs-keyword">break</span>

      <span class="hljs-keyword">case</span> <span class="hljs-string">'end'</span>:
        e.preventDefault();
        <span class="hljs-keyword">if</span>(onLast) <span class="hljs-keyword">break</span>
        Slides.go(<span class="hljs-string">'last'</span>)
        <span class="hljs-keyword">break</span>

      <span class="hljs-keyword">case</span> <span class="hljs-string">'toggle'</span>:
        e.preventDefault();
        Interface.toggle();
        <span class="hljs-keyword">break</span>

      <span class="hljs-keyword">case</span> <span class="hljs-string">'dim'</span>:
        e.preventDefault()
        App.setState({
          dimmer: !App.state.dimmer
        })

      <span class="hljs-keyword">default</span>:
        <span class="hljs-keyword">break</span>
    }
  },

  <span class="hljs-comment">/** instantiate event listeners on key press */</span>
  addKeyPressEvents: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    $(<span class="hljs-built_in">document</span>).keydown(Interface.handleKeyPress);
  },

  <span class="hljs-comment">/** disables the transition event listeners */</span>
  disableTransitions: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    $(<span class="hljs-built_in">document</span>).unbind(<span class="hljs-string">'keydown'</span>, Interface.handleKeyPress)

    $button.first.off(<span class="hljs-string">'click'</span>);
    $button.prev.off(<span class="hljs-string">'click'</span>);
    $button.next.off(<span class="hljs-string">'click'</span>);
    $button.last.off(<span class="hljs-string">'click'</span>);
  },

  <span class="hljs-comment">/** add or restore the transition event listeners */</span>
  restoreTransitions: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    Interface.addKeyPressEvents()
    Interface.addNavigationListeners()
  },

  <span class="hljs-comment">/** event triggers */</span>

  updateButtons: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{ $(Interface).trigger(<span class="hljs-string">'interface:update-btns'</span>) },
  toggleUI: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{ $(Interface).trigger(<span class="hljs-string">'interface:toggle'</span>) },

  toggle: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{ App.setState({buttonShown: !App.state.buttonShown }) },

  <span class="hljs-comment">/** event handlers */</span>

  <span class="hljs-comment">/**
   * toggle classes from buttons
   */</span>
  onToggleButtons: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> currentSlide = App.state.currentSlide,
        lastSlide    = App.state.totalSlides,
        allButtons   = $button.wrapper.children(),
        allDisabled  = $(allButtons[<span class="hljs-number">0</span>]).is(<span class="hljs-string">'disabled'</span>);

    <span class="hljs-comment">/**
      * should be true after the next if statement is executed.
      * prevents useless checking if there is just one slide to show
      * and buttons are already disabled.
      * could be deprecated since there is no way onToggleButtons() is called
      * if there is just one slide to show
     */</span>
    <span class="hljs-keyword">if</span> (lastSlide === <span class="hljs-number">1</span> &amp;&amp; allDisabled) <span class="hljs-keyword">return</span>;

    <span class="hljs-comment">/**
     * should be true just the first time it runs or never.
     * disables all the buttons if there is just one slide to show
     * and the first one is not disabled
     */</span>
    <span class="hljs-keyword">if</span> (lastSlide === <span class="hljs-number">1</span> &amp;&amp; !allDisabled) {
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; allButtons.length; i++) {
        <span class="hljs-keyword">var</span> button = $(allButtons[i]);
        button.addClass(<span class="hljs-string">'disabled'</span>);
      };
      <span class="hljs-keyword">return</span>
    };

    <span class="hljs-comment">/**
     * check current slideshow status and toggle disable class from buttons
     * if and where needed.
     */</span>
    <span class="hljs-keyword">if</span> (currentSlide === <span class="hljs-number">1</span>) {
      $button.first.addClass(<span class="hljs-string">'disabled'</span>);
      $button.prev.addClass(<span class="hljs-string">'disabled'</span>);
    } <span class="hljs-keyword">else</span> {
      $button.first.removeClass(<span class="hljs-string">'disabled'</span>);
      $button.prev.removeClass(<span class="hljs-string">'disabled'</span>);
    };

    <span class="hljs-keyword">if</span> (currentSlide === lastSlide) {
      $button.next.addClass(<span class="hljs-string">'disabled'</span>);
      $button.last.addClass(<span class="hljs-string">'disabled'</span>);
    } <span class="hljs-keyword">else</span> {
      $button.next.removeClass(<span class="hljs-string">'disabled'</span>);
      $button.last.removeClass(<span class="hljs-string">'disabled'</span>);
    };
  },
  <span class="hljs-comment">/**
   * Toggle the buttons (and count)
   */</span>
  onToggleUI: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> state = App.state.buttonShown;

    $button.wrapper.transition(<span class="hljs-string">'fly left'</span>);
    Counter.toggle();
  }
};


<span class="hljs-comment">/**
 * STORAGE SECTION
 *
 * After here you can find temporary unused functions and methods that are
 * not deleted because they will be useful in future updates and functionalities
 * but are not used currently from the app.
 * @namespace
 */</span>
<span class="hljs-keyword">var</span> STORAGE = {
  <span class="hljs-comment">/**
   * Can validate a @prop {string} &lt;status&gt; using an array of values
   * <span class="hljs-doctag">TODO:</span> Move somewhere. can be used to validate transition selection
   *       &amp; customization, using an array of valid strings.
   *
   * Validate the dimmer transitions. true or an error if validation is falsy
   * @param  {string} status     desired new status to validate. optional
   * @param  {array}  array      Array of valid values to check with
   * @return {bool/error}        true if valid, undefined if not
   *                             will throw an error if not valid
   */</span>
  validate: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">status, validationArray</span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <p> if nothing is passed assume we want to toggle</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span> (!status) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;

    <span class="hljs-comment">/** validation rules */</span>
    <span class="hljs-keyword">var</span> states        = validationArray,
        isString      = <span class="hljs-keyword">typeof</span> status === <span class="hljs-string">'string'</span>,
        <span class="hljs-comment">/** actual validation of the passed string */</span>
        isValid       = (<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
          <span class="hljs-keyword">var</span> valid = <span class="hljs-literal">false</span>
          <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; states.length; i++) {
            <span class="hljs-keyword">if</span> (status === states[i]) valid = <span class="hljs-literal">true</span>;
          }
          <span class="hljs-keyword">return</span> valid
        })();

    <span class="hljs-comment">/** error handling */</span>
    <span class="hljs-keyword">if</span> (status &amp;&amp; !isString) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'dimmer received an invalid status property somewhere!'</span>)
    };

    <span class="hljs-keyword">if</span> (status &amp;&amp; isString &amp;&amp; !isValid) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'passed status value to Dimmer is not valid. check'</span>)
    };

    <span class="hljs-comment">/** everything is valid. return true */</span>
    <span class="hljs-keyword">if</span> (status &amp;&amp; isString &amp;&amp; isValid) { <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span> }

    <span class="hljs-comment">/** in case something went wrong, throws an error to notify */</span>
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'Something went wrong while validating'</span>)
  }
};</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
